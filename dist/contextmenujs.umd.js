var L=Object.defineProperty;var C=(i,c,h)=>c in i?L(i,c,{enumerable:!0,configurable:!0,writable:!0,value:h}):i[c]=h;var p=(i,c,h)=>(C(i,typeof c!="symbol"?c+"":c,h),h);(function(i,c){typeof exports=="object"&&typeof module!="undefined"?module.exports=c():typeof define=="function"&&define.amd?define(c):(i=typeof globalThis!="undefined"?globalThis:i||self,i.MyLib=c())})(this,function(){"use strict";function i(s,e,n){return m(s[e])?s[e]:n}function c(s){const e=Array.from(s.getElementsByTagName("li"));let n=0,o=0;for(const d of e)n=Math.max(d.offsetWidth,n),o=Math.max(d.offsetHeight,o);let t=n,r=o;for(const d of e){const l=d.getElementsByTagName("ul")[0];if(m(l)){const f=c(l);t=Math.max(n+f.width,t),r=Math.max(o+f.height,r)}}return{width:t,height:r}}function h(s){return typeof s=="undefined"}function m(s){return!h(s)}function w(s){return s!==null&&typeof s=="object"}var y;(function(s){s.MENU_DIVIDER="cm_divider"})(y||(y={}));let E=(s=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(s));for(;s--;){let o=n[s]&63;o<36?e+=o.toString(36):o<62?e+=(o-26).toString(36).toUpperCase():o<63?e+="_":e+="-"}return e};class x{constructor(e,n){p(this,"instance_id");p(this,"context_target");p(this,"menu",[]);p(this,"options",{});if(this.onDocumentClick=this.onDocumentClick.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.instance_id=`cm_${E()}`,!(e instanceof Array))throw new Error("Parameter 1 must be of type Array");if(this.menu=e,m(n)){if(!w(n))throw new Error("Parameter 2 must be of type object");this.options=n}window.addEventListener("resize",this.onWindowResize),this.reload()}onWindowResize(){i(this.options,"close_on_resize",!0)&&this.hide()}setOptions(e){if(w(e))this.options=e;else throw new Error("Parameter 1 must be of type object")}changeOption(e,n){if(typeof e=="string")if(m(n))this.options[e]=n;else throw new Error("Parameter 2 must be set");else throw new Error("Parameter 1 must be of type string")}getOptions(){return this.options}reload(){const e=this.menu;this.dom===null&&this.addDom();const n=this.dom;n.innerHTML="",n.appendChild(this.renderLevel(e))}display(e,n){const o=this.options;this.context_target=m(n)?n:e.target;const t=this.dom,r={x:e.clientX,y:e.clientY},d=r.x,a=r.y,l=t.offsetWidth+4,f=t.offsetHeight+4,u=window.innerWidth,_=window.innerHeight,b=parseInt(i(o,"mouse_offset",2));u-d<l?t.style.left=`${u-l}px`:t.style.left=`${d+b}px`,_-a<f?t.style.top=`${_-f}px`:t.style.top=`${a+b}px`;const g=c(t);u-d<g.width?t.classList.add("cm_border_right"):t.classList.remove("cm_border_right"),_-a<g.height?t.classList.add("cm_border_bottom"):t.classList.remove("cm_border_bottom"),t.classList.add("display"),i(o,"close_on_click",!0)&&window.addEventListener("click",this.onDocumentClick),e.preventDefault()}hide(){var e;(e=this.dom)==null||e.classList.remove("display"),window.removeEventListener("click",this.onDocumentClick)}get dom(){const e=this.instance_id;return document.getElementById(e)}addDom(){const e=this.instance_id,n=document.createElement("div");n.className="cm_container",n.id=e,document.body.appendChild(n)}onDocumentClick(){this.hide()}renderLevel(e){const n=this.options,o=document.createElement("ul");return e.forEach(t=>{const r=document.createElement("li");if(h(t.type)){const d=document.createElement("span");d.className="cm_icon_span",i(t,"icon","")!==""?d.innerHTML=i(t,"icon",""):d.innerHTML=i(n,"default_icon","");const a=document.createElement("span");a.className="cm_text",i(t,"text","")!==""?a.innerHTML=i(t,"text",""):a.innerHTML=i(this.options,"default_text","item");const l=document.createElement("span");if(l.className="cm_sub_span",typeof t.sub!="undefined"&&(i(n,"sub_icon","")!==""?l.innerHTML=i(this.options,"sub_icon",""):l.innerHTML="&#155;"),r.appendChild(d),r.appendChild(a),r.appendChild(l),!i(t,"enabled",!0))r.setAttribute("disabled","");else{if(typeof t.events=="object"){const f=Object.keys(t.events);for(let u=0;u<f.length;u++)r.addEventListener(f[u],t.events[f[u]])}typeof t.sub!="undefined"&&r.appendChild(this.renderLevel(t.sub))}}else t.type===y.MENU_DIVIDER&&(r.className=y.MENU_DIVIDER);o.appendChild(r)}),o}}return x});
